import B from"./button.esm.8409976c.js";import D from"./chips.esm.fac04679.js";import E from"./dialog.esm.d37f1382.js";import{u as N,r as u,o,n as j,w as C,b as f,q as r,a as e,s as R,v as F,x as S,y as T,c as l,F as v,z as $,A as h,t as A}from"./entry.666009fa.js";import{u as U}from"./global.dfb72d1c.js";import"./badge.esm.6895c8b8.js";import"./basecomponent.esm.bd035da6.js";import"./index.esm.358e1f0f.js";import"./baseicon.esm.7641c93a.js";import"./index.esm.844658d9.js";import"./index.esm.f449d5eb.js";import"./portal.esm.3511df99.js";const q=e("div",{class:"inline-flex align-items-center justify-content-center gap-2"},[e("span",{class:"font-bold white-space-nowrap uppercase"}," Ajout de catégorie ")],-1),G={class:"flex flex-col"},H={class:"flex flex-col w-full"},L=e("span",{class:""},' Ecrivez puis tapez sur "entrer" pour entrer une nouvelle ',-1),M={__name:"addCat",props:["visible"],emits:["close","validate"],setup(V,{emit:x}){N();const m=V,b=x,i=u(null),c=u(!1);async function p(){c.value=!0;try{(await $fetch("/api/a/admin/cats",{method:"post",body:{cats:i.value}})).status&&(i.value=[],b("validate"))}catch(d){console.log(d)}c.value=!1}return(d,a)=>{const g=D,y=B,w=E;return o(),j(w,{visible:m.visible,"onUpdate:visible":[a[1]||(a[1]=_=>m.visible=_),a[2]||(a[2]=()=>{b("close")})],modal:"",header:"Header",style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{header:C(()=>[q]),footer:C(()=>[f(y,{label:"Enregistrer les catégories",class:"p-2",loading:r(c),icon:"pi pi-check",onClick:p,autofocus:""},null,8,["loading"])]),default:C(()=>[e("div",G,[e("div",H,[L,f(g,{class:"w-full",modelValue:r(i),"onUpdate:modelValue":a[0]||(a[0]=_=>R(i)?i.value=_:null)},null,8,["modelValue"])])])]),_:1},8,["visible"])}}},P={class:"bg-gray-100 flex justify-center"},I={class:"w-[700px] flex flex-col"},J={class:"flex p-2 border-b items-center"},K=e("span",null," Admin ",-1),O=e("span",{class:"flex-grow"},null,-1),Q={class:"flex flex-col bg-white rounded border-b mb-2"},W={class:"flex items-center p-2"},X=e("span",{class:"p-2 font-bold text-green-500 underline"}," Catégorie ",-1),Y=e("span",{class:"flex-grow"},null,-1),Z={class:"flex flex-col border p-2 max-h-[300px] overflow-auto"},ee={class:"capitalize"},te=e("span",{class:"flex-grow"},null,-1),se=["onClick"],oe={key:0,class:"text-center"},ae={class:"flex flex-col border-b mb-2 max-h-[300px] overflow-auto bg-white rounded"},ne=e("span",{class:"p-2 underline font-bold text-green-500"}," Créateurs ",-1),le={class:"flex flex-col border p-2"},ce={class:"cursor-pointer"},re=e("span",{class:"flex-grow"},null,-1),ie={key:0,class:"text-center"},de={class:"flex flex-col border-b mb-2 max-h-[300px] overflow-auto bg-white rounded"},ue=e("span",{class:"p-2 underline font-bold text-green-500"}," Produits ",-1),pe={class:"flex flex-col border p-2"},_e={class:""},fe={key:0,class:"text-center"},Be={__name:"admin",setup(V){const x=U(),{user:m,connected:b}=F(x),i=S(),c=u([]),p=u([]),d=u([]),a=u(!1);async function g(){try{(await $fetch("/api/a/deconnect")).status&&(m.value={},b.value=!1,i.push("/"))}catch(t){console.log(t)}}async function y(){try{const t=await $fetch("/api/a/admin/cats");t.status&&(c.value=t.cats)}catch(t){console.log(t)}}async function w(t){try{const n=await $fetch(`/api/a/admin/cat/${t}`,{method:"delete"});n.status&&(c.value=n.cats)}catch(n){console.log(n)}}async function _(){try{const t=await $fetch("/api/a/admin/all-data");t.status&&(c.value=t.cats,p.value=t.prods,d.value=t.creators)}catch(t){console.log(t)}}return T(()=>{_()}),(t,n)=>{const k=B,z=M;return o(),l(v,null,[e("div",P,[e("div",I,[e("div",J,[K,O,f(k,{class:"p-button-sm p-button-danger p-1",label:"Deconnexion",icon:"pi pi-times",onClick:g})]),e("div",Q,[e("div",W,[X,Y,f(k,{icon:"pi pi-plus",label:"Ajouter",onClick:n[0]||(n[0]=s=>a.value=!0),class:"p-button-sm p-1"})]),e("div",Z,[(o(!0),l(v,null,$(r(c),s=>(o(),l("div",{class:"p-1 hover:bg-gray-50 border-b flex justify-center",key:s.cat_id},[e("span",ee,A(s.cat_label),1),te,e("button",{class:"p-2 hover:bg-gray-600 hover:text-white border",onClick:me=>w(s.cat_id)}," - ",8,se)]))),128)),r(c).length<=0?(o(),l("span",oe," Aucune catégorie ")):h("",!0)])]),e("div",ae,[ne,e("div",le,[(o(!0),l(v,null,$(r(d),s=>(o(),l("div",{class:"p-1 hover:bg-gray-50 border-b flex items-center",key:s.cre_id},[e("span",ce,A(s.cre_label),1),re,s.cre_validate?h("",!0):(o(),j(k,{key:0,class:"p-1 p-button-sm p-button-warning",label:"Valider"}))]))),128)),r(d).length==0?(o(),l("span",ie," Aucun créateur ")):h("",!0)])]),e("div",de,[ue,e("div",pe,[(o(!0),l(v,null,$(r(p),s=>(o(),l("div",{class:"p-1 hover:bg-gray-50 border-b",key:s.prod_id},[e("span",_e,A(s.prod_label),1)]))),128)),r(p).length==0?(o(),l("span",fe," Aucun produit ")):h("",!0)])])])]),f(z,{visible:r(a),onClose:n[1]||(n[1]=s=>a.value=!1),onValidate:n[2]||(n[2]=()=>{a.value=!1,y()})},null,8,["visible"])],64)}}};export{Be as default};
